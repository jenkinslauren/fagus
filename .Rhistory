install.packages('Rcpp')
install.packages('devtools')
install.packages('Rdpack')
rm(list=ls())
library(raster)
library(rgeos)
library(enmSdm)
library(gtools)
library(spatialEco)
library(stats)
library(maps)
library(rnaturalearth)
library(cowplot)
library(ggrepel)
library(RColorBrewer)
colors <- c('#d73027','#f46d43','#fdae61','#fee08b','#ffffbf','#d9ef8b','#a6d96a','#66bd63','#1a9850')
genus <- 'fagus'
setwd(paste0('/Volumes/lj_mac_22/MOBOT/by_genus/', genus))
gcmList <- c('hadley', 'ccsm', 'ecbilt')
pc <- 5
climYears <- seq(21000, 0, by=-1000)
world <- ne_countries(scale = "medium", returnclass = "sf")
world <- as(world, "Spatial")
pollenFileName <- paste0('/Volumes/lj_mac_22/pollen/predictions-',
toupper(genus),
'_meanpred_iceMask.tif')
pollenRast <- stack(pollenFileName)
names(pollenRast) <- c(paste0("Fraxinus_pollen_predictions_", 0:21, "kybp"))
pollenRast <- unstack(pollenRast)
pollenRast <- stack(rev(pollenRast))
load('/Volumes/lj_mac_22/MOBOT/by_genus/study_region/Study Region Extent.Rdata')
### pollen biotic velocity ###
projection(pollenRast) <- getCRS('albersNA')
# note: there is no difference in output between onlyInSharedCells = T & F
bvPollen <- bioticVelocity(pollenRast, times = seq(-21000, 0, by = 1000),
onlyInSharedCells = T)
bvPollen$time <- paste0(abs(bvPollen$timeFrom)/1000, '-',
abs(bvPollen$timeTo)/1000, ' kybp')
bvPollen$time <- factor(bvPollen$time, levels = rev(mixedsort(bvPollen$time)))
bvPollen_plot <- ggplot(bvPollen, aes(x = time, y = centroidVelocity, group = 1)) +
geom_line() + geom_point() +
theme_classic() +
ggtitle("Pollen") + xlab("time period") + ylab("centroid velocity (m/yr)") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
### hadley biotic velocity ###
gcm <- 'hadley'
load(paste0('./workspaces/07 - ', gcm, ' genus merge'))
# hadley means #
stackMeansList <- stack(meansList)
projection(stackMeansList) <- getCRS('albersNA')
bvHadleyMeans <- bioticVelocity(stackMeansList, times = seq(-21000, 0, by = 1000),
onlyInSharedCells = T)
bvHadleyMeans$time <- paste0(abs(bvHadleyMeans$timeFrom)/1000, '-',
abs(bvHadleyMeans$timeTo)/1000, ' kybp')
bvHadleyMeans$time <- factor(bvHadleyMeans$time,
levels = rev(mixedsort(bvHadleyMeans$time)))
bvHadleyMeans_plot <- ggplot(bvHadleyMeans, aes(time, centroidVelocity, group = 1)) +
geom_point() + geom_line() +
ggtitle("HadAM3H Means") + xlab("time period") + ylab("centroid velocity (m/yr)") +
theme_classic() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
# hadley max #
stackMaxList <- stack(maxList)
projection(stackMaxList) <- getCRS('albersNA')
bvHadleyMax <- bioticVelocity(stackMaxList, times = seq(-21000, 0, by = 1000),
onlyInSharedCells = T)
bvHadleyMax$time <- paste0(abs(bvHadleyMax$timeFrom)/1000, '-',
abs(bvHadleyMax$timeTo)/1000, ' kybp')
bvHadleyMax$time <- factor(bvHadleyMax$time,
levels = rev(mixedsort(bvHadleyMax$time)))
bvHadleyMax_plot <- ggplot(bvHadleyMax, aes(time, centroidVelocity, group = 1)) +
geom_point() + geom_line() +
ggtitle("HadAM3H Max") + xlab("time period") + ylab("centroid velocity (m/yr)") +
theme_classic() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
### ccsm biotic velocity ###
gcm <- 'ccsm'
load(paste0('./workspaces/07 - ', gcm, ' genus merge'))
# ccsm means #
stackMeansList <- stack(meansList)
projection(stackMeansList) <- getCRS('albersNA')
bvCCSMMeans <- bioticVelocity(stackMeansList, times = seq(-21000, 0, by = 1000),
onlyInSharedCells = T)
bvCCSMMeans$time <- paste0(abs(bvCCSMMeans$timeFrom)/1000, '-',
abs(bvCCSMMeans$timeTo)/1000, ' kybp')
bvCCSMMeans$time <- factor(bvCCSMMeans$time,
levels = rev(mixedsort(bvCCSMMeans$time)))
bvCCSMMeans_plot <- ggplot(bvCCSMMeans, aes(time, centroidVelocity, group = 1)) +
geom_point() + geom_line() +
ggtitle("CCSM Means") + xlab("time period") + ylab("centroid velocity (m/yr)") +
theme_classic() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
# ccsm max #
stackMaxList <- stack(maxList)
projection(stackMaxList) <- getCRS('albersNA')
bvCCSMMax <- bioticVelocity(stackMaxList, times = seq(-21000, 0, by = 1000),
onlyInSharedCells = T)
bvCCSMMax$time <- paste0(abs(bvCCSMMax$timeFrom)/1000, '-',
abs(bvCCSMMax$timeTo)/1000, ' kybp')
bvCCSMMax$time <- factor(bvCCSMMax$time,
levels = rev(mixedsort(bvCCSMMax$time)))
bvCCSMMax_plot <- ggplot(bvCCSMMax, aes(time, centroidVelocity, group = 1)) +
geom_point() + geom_line() +
ggtitle("CCSM Max") + xlab("time period") + ylab("centroid velocity (m/yr)") +
theme_classic() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
### ecbilt biotic velocity ###
gcm <- 'ecbilt'
load(paste0('./workspaces/07 - ', gcm, ' genus merge'))
# ecbilt means #
stackMeansList <- stack(meansList)
projection(stackMeansList) <- getCRS('albersNA')
bvECBiltMeans <- bioticVelocity(stackMeansList, times = seq(-21000, 0, by = 1000),
onlyInSharedCells = T)
bvECBiltMeans$time <- paste0(abs(bvECBiltMeans$timeFrom)/1000, '-',
abs(bvECBiltMeans$timeTo)/1000, ' kybp')
bvECBiltMeans$time <- factor(bvECBiltMeans$time,
levels = rev(mixedsort(bvECBiltMeans$time)))
bvECBiltMeans_plot <- ggplot(bvECBiltMeans, aes(time, centroidVelocity, group = 1)) +
geom_point() + geom_line() +
ggtitle("ECBilt Means") + xlab("time period") + ylab("centroid velocity (m/yr)") +
theme_classic() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
# ecbilt max #
stackMaxList <- stack(maxList)
projection(stackMaxList) <- getCRS('albersNA')
bvECBiltMax <- bioticVelocity(stackMaxList, times = seq(-21000, 0, by = 1000),
onlyInSharedCells = T)
bvECBiltMax$time <- paste0(abs(bvECBiltMax$timeFrom)/1000, '-',
abs(bvECBiltMax$timeTo)/1000, ' kybp')
bvECBiltMax$time <- factor(bvECBiltMax$time,
levels = rev(mixedsort(bvECBiltMax$time)))
bvECBiltMax_plot <- ggplot(bvECBiltMax, aes(time, centroidVelocity, group = 1)) +
geom_point() + geom_line() +
ggtitle("ECBilt Max") + xlab("time period") + ylab("centroid velocity (m/yr)") +
theme_classic() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
# combine all biotic velocities into one df for plotting #
bv_all <- data.frame(bvPollen$time,
bvPollen$centroidVelocity,
bvHadleyMeans$centroidVelocity,
bvCCSMMeans$centroidVelocity,
bvECBiltMeans$centroidVelocity)
colnames(bv_all) <- c("Time", "Pollen","HadAM3H", "CCSM", "ECBilt")
bv_all <- cbind(bv_all[1], utils::stack(bv_all[2:5]))
colnames(bv_all) <- c("Time", "centroidVelocity", "climateSource")
pdf(file = paste0('./pdf/biotic_velocity.pdf'), width = 11, height = 8.5)
plot_grid(bvPollen_plot, plot_grid(bvHadleyMeans_plot, bvHadleyMax_plot),
plot_grid(bvCCSMMeans_plot, bvCCSMMax_plot),
plot_grid(bvECBiltMeans_plot, bvECBiltMax_plot), ncol = 1)
ymax <- ceiling(max(bv_all$centroidVelocity))
ymin <- floor(min(bv_all$centroidVelocity))
dev.off()
nsQuant05Pollen_plot <- ggplot(bvPollen, aes(time, nsQuantVelocity_quant0p05, group = 1)) +
geom_hline(yintercept = 0, linetype = "dashed", color = "red", size=0.5) +
geom_point() + geom_line() +
ggtitle("Shared Cells Only") +
xlab("time period") + ylab("velocity (m/yr)") +
theme_classic() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
plot.title = element_text(size = 12, hjust = 0.5))
nsQuant95Pollen_plot <- ggplot(bvPollen, aes(time, nsQuantVelocity_quant0p95, group = 1)) +
geom_hline(yintercept = 0, linetype = "dashed", color = "red", size=0.5) +
geom_point() + geom_line() +
ggtitle("Shared Cells Only") +
xlab("time period") + ylab("velocity (m/yr)") +
theme_classic() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
plot.title = element_text(size = 12, hjust = 0.5))
nsQuant05Hadley_plot <- ggplot(bvHadleyMeans, aes(time, nsQuantVelocity_quant0p05, group = 1)) +
geom_hline(yintercept=0, linetype="dashed", color = "red", size=0.5) +
geom_point() + geom_line() +
ggtitle("Shared Cells Only") +
xlab("time period") + ylab("velocity (m/yr)") +
theme_classic() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
plot.title = element_text(size = 12, hjust = 0.5))
nsQuant95Hadley_plot <- ggplot(bvHadleyMeans, aes(time, nsQuantVelocity_quant0p95, group = 1)) +
geom_hline(yintercept=0, linetype="dashed", color = "red", size=0.5) +
geom_point + geom_line() +
ggtitle("Shared Cells Only") +
xlab("time period") + ylab("velocity (m/yr)") +
theme_classic() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
plot.title = element_text(size = 12, hjust = 0.5))
nsQuant05CCSM_plot <- ggplot(bvCCSMMeans, aes(time, nsQuantVelocity_quant0p05, group = 1)) +
geom_hline(yintercept=0, linetype="dashed", color = "red", size=0.5) +
geom_point() + geom_line() +
ggtitle("Shared Cells Only") +
xlab("time period") + ylab("velocity (m/yr)") +
theme_classic() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
plot.title = element_text(size = 12, hjust = 0.5))
nsQuant95Hadley_plot <- ggplot(bvHadleyMeans, aes(time, nsQuantVelocity_quant0p95, group = 1)) +
geom_hline(yintercept=0, linetype="dashed", color = "red", size=0.5) +
geom_point + geom_line() +
ggtitle("Shared Cells Only") +
xlab("time period") + ylab("velocity (m/yr)") +
theme_classic() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
plot.title = element_text(size = 12, hjust = 0.5))
nsQuant95Hadley_plot <- ggplot(bvHadleyMeans, aes(time, nsQuantVelocity_quant0p95, group = 1)) +
geom_hline(yintercept=0, linetype="dashed", color = "red", size=0.5) +
geom_point() + geom_line() +
ggtitle("Shared Cells Only") +
xlab("time period") + ylab("velocity (m/yr)") +
theme_classic() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
plot.title = element_text(size = 12, hjust = 0.5))
nsQuant05CCSM_plot <- ggplot(bvCCSMMeans, aes(time, nsQuantVelocity_quant0p05, group = 1)) +
geom_hline(yintercept=0, linetype="dashed", color = "red", size=0.5) +
geom_point() + geom_line() +
ggtitle("Shared Cells Only") +
xlab("time period") + ylab("velocity (m/yr)") +
theme_classic() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
plot.title = element_text(size = 12, hjust = 0.5))
nsQuant95CCSM_plot <- ggplot(bvCCSMMeans, aes(time, nsQuantVelocity_quant0p95, group = 1)) +
geom_hline(yintercept=0, linetype="dashed", color = "red", size=0.5) +
geom_point + geom_line() +
ggtitle("Shared Cells Only") +
xlab("time period") + ylab("velocity (m/yr)") +
theme_classic() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
plot.title = element_text(size = 12, hjust = 0.5))
nsQuant95CCSM_plot <- ggplot(bvCCSMMeans, aes(time, nsQuantVelocity_quant0p95, group = 1)) +
geom_hline(yintercept=0, linetype="dashed", color = "red", size=0.5) +
geom_point() + geom_line() +
ggtitle("Shared Cells Only") +
xlab("time period") + ylab("velocity (m/yr)") +
theme_classic() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
plot.title = element_text(size = 12, hjust = 0.5))
nsQuant05ECBilt_plot <- ggplot(bvECBiltMeans, aes(time, nsQuantVelocity_quant0p05, group = 1)) +
geom_hline(yintercept=0, linetype="dashed", color = "red", size=0.5) +
geom_point() + geom_line() +
ggtitle("Shared Cells Only") +
xlab("time period") + ylab("velocity (m/yr)") +
theme_classic() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
plot.title = element_text(size = 12, hjust = 0.5))
nsQuant95ECBilt_plot <- ggplot(bvECBiltMeans, aes(time, nsQuantVelocity_quant0p95, group = 1)) +
geom_hline(yintercept=0, linetype="dashed", color = "red", size=0.5) +
geom_point() + geom_line() +
ggtitle("Shared Cells Only") +
xlab("time period") + ylab("velocity (m/yr)") +
theme_classic() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
plot.title = element_text(size = 12, hjust = 0.5))
title05 <- ggdraw() +
draw_label(label = "Biotic Velocity of Southern Edge (5th quantile)\n",
fontface = 'bold', hjust = 0.5) +
draw_label(label = "\nPollen", hjust = 0.5)
title95 <- ggdraw() +
draw_label("Biotic Velocity of Northern Edge (95th quantile)",
fontface = 'bold', hjust = 0.5)
plot_grid(title05, plot_grid(nsQuant05Pollen_plot, nsQuant05Hadley_plot,
nsQuant05CCSM_plot, nsQuant05ECBilt_plot, ncol = 2),
title95,
plot_grid(nsQuant95Pollen_plot, nsQuant95Hadley_plot,
nsQuant95CCSM_plot, nsQuant95ECBilt_plot, ncol = 2),
ncol = 1, rel_heights = c(0.2, 1))
pdf(file = './pdf/ns_quant.pdf', width = 11, height = 8.5)
plot_grid(title05, plot_grid(nsQuant05Pollen_plot, nsQuant05Hadley_plot,
nsQuant05CCSM_plot, nsQuant05ECBilt_plot, ncol = 2),
title95,
plot_grid(nsQuant95Pollen_plot, nsQuant95Hadley_plot,
nsQuant95CCSM_plot, nsQuant95ECBilt_plot, ncol = 2),
ncol = 1, rel_heights = c(0.2, 1))
dev.off()
nsQuant05Pollen_plot <- ggplot(bvPollen, aes(time, nsQuantVelocity_quant0p05, group = 1)) +
geom_hline(yintercept = 0, linetype = "dashed", color = "red", size=0.5) +
geom_point() + geom_line() +
ggtitle("Pollen") +
xlab("time period") + ylab("velocity (m/yr)") +
theme_classic() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
plot.title = element_text(size = 12, hjust = 0.5))
nsQuant95Pollen_plot <- ggplot(bvPollen, aes(time, nsQuantVelocity_quant0p95, group = 1)) +
geom_hline(yintercept = 0, linetype = "dashed", color = "red", size=0.5) +
geom_point() + geom_line() +
ggtitle("Pollen") +
xlab("time period") + ylab("velocity (m/yr)") +
theme_classic() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
plot.title = element_text(size = 12, hjust = 0.5))
nsQuant05Hadley_plot <- ggplot(bvHadleyMeans, aes(time, nsQuantVelocity_quant0p05, group = 1)) +
geom_hline(yintercept=0, linetype="dashed", color = "red", size=0.5) +
geom_point() + geom_line() +
ggtitle("SDM (GCM = HadAM3H)") +
xlab("time period") + ylab("velocity (m/yr)") +
theme_classic() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
plot.title = element_text(size = 12, hjust = 0.5))
nsQuant95Hadley_plot <- ggplot(bvHadleyMeans, aes(time, nsQuantVelocity_quant0p95, group = 1)) +
geom_hline(yintercept=0, linetype="dashed", color = "red", size=0.5) +
geom_point() + geom_line() +
ggtitle("SDM (GCM = HadAM3H)") +
xlab("time period") + ylab("velocity (m/yr)") +
theme_classic() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
plot.title = element_text(size = 12, hjust = 0.5))
nsQuant05CCSM_plot <- ggplot(bvCCSMMeans, aes(time, nsQuantVelocity_quant0p05, group = 1)) +
geom_hline(yintercept=0, linetype="dashed", color = "red", size=0.5) +
geom_point() + geom_line() +
ggtitle("SDM (GCM = CCSM)") +
xlab("time period") + ylab("velocity (m/yr)") +
theme_classic() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
plot.title = element_text(size = 12, hjust = 0.5))
nsQuant95CCSM_plot <- ggplot(bvCCSMMeans, aes(time, nsQuantVelocity_quant0p95, group = 1)) +
geom_hline(yintercept=0, linetype="dashed", color = "red", size=0.5) +
geom_point() + geom_line() +
ggtitle("SDM (GCM = CCSM)") +
xlab("time period") + ylab("velocity (m/yr)") +
theme_classic() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
plot.title = element_text(size = 12, hjust = 0.5))
nsQuant05ECBilt_plot <- ggplot(bvECBiltMeans, aes(time, nsQuantVelocity_quant0p05, group = 1)) +
geom_hline(yintercept=0, linetype="dashed", color = "red", size=0.5) +
geom_point() + geom_line() +
ggtitle("SDM (GCM = ECBilt)") +
xlab("time period") + ylab("velocity (m/yr)") +
theme_classic() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
plot.title = element_text(size = 12, hjust = 0.5))
nsQuant95ECBilt_plot <- ggplot(bvECBiltMeans, aes(time, nsQuantVelocity_quant0p95, group = 1)) +
geom_hline(yintercept=0, linetype="dashed", color = "red", size=0.5) +
geom_point() + geom_line() +
ggtitle("SDM (GCM = ECBilt)") +
xlab("time period") + ylab("velocity (m/yr)") +
theme_classic() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
plot.title = element_text(size = 12, hjust = 0.5))
title05 <- ggdraw() +
draw_label(label = "Biotic Velocity of Southern Edge (5th quantile)\n",
fontface = 'bold', hjust = 0.5) +
draw_label(label = "\nPollen", hjust = 0.5)
title95 <- ggdraw() +
draw_label("Biotic Velocity of Northern Edge (95th quantile)",
fontface = 'bold', hjust = 0.5)
pdf(file = './pdf/ns_quant.pdf', width = 11, height = 8.5)
plot_grid(title05, plot_grid(nsQuant05Pollen_plot, nsQuant05Hadley_plot,
nsQuant05CCSM_plot, nsQuant05ECBilt_plot, ncol = 2),
title95,
plot_grid(nsQuant95Pollen_plot, nsQuant95Hadley_plot,
nsQuant95CCSM_plot, nsQuant95ECBilt_plot, ncol = 2),
ncol = 1, rel_heights = c(0.2, 1))
dev.off()
title05 <- ggdraw() +
draw_label(label = "Biotic Velocity of Southern Edge (5th quantile)\n",
fontface = 'bold', hjust = 0.5)
title95 <- ggdraw() +
draw_label("Biotic Velocity of Northern Edge (95th quantile)",
fontface = 'bold', hjust = 0.5)
pdf(file = './pdf/ns_quant.pdf', width = 11, height = 8.5)
plot_grid(title05, plot_grid(nsQuant05Pollen_plot, nsQuant05Hadley_plot,
nsQuant05CCSM_plot, nsQuant05ECBilt_plot, ncol = 2),
title95,
plot_grid(nsQuant95Pollen_plot, nsQuant95Hadley_plot,
nsQuant95CCSM_plot, nsQuant95ECBilt_plot, ncol = 2),
ncol = 1, rel_heights = c(0.2, 1))
dev.off()
plot_grid(plot_grid(title05, title95, ncol = 2),
plot_grid(nsQuant05Pollen_plot, nsQuant95Pollen_plot,
nsQuant05Hadley_plot, nsQuant95Hadley_plot,
nsQuant05CCSM_plot, nsQuant95CCSM_plot,
nsQuant05ECBilt_plot, nsQuant95ECBilt_plot, ncol = 2))
plot_grid(title05, title95, nsQuant05Pollen_plot, nsQuant95Pollen_plot,
nsQuant05Hadley_plot, nsQuant95Hadley_plot,
nsQuant05CCSM_plot, nsQuant95CCSM_plot,
nsQuant05ECBilt_plot, nsQuant95ECBilt_plot, ncol = 2)
pdf(file = './pdf/ns_quant.pdf', width = 11, height = 8.5)
plot_grid(title05, plot_grid(nsQuant05Pollen_plot, nsQuant05Hadley_plot,
nsQuant05CCSM_plot, nsQuant05ECBilt_plot, ncol = 2),
title95,
plot_grid(nsQuant95Pollen_plot, nsQuant95Hadley_plot,
nsQuant95CCSM_plot, nsQuant95ECBilt_plot, ncol = 2),
ncol = 1, rel_heights = c(0.2, 1))
plot_grid(title05, title95, nsQuant05Pollen_plot, nsQuant95Pollen_plot,
nsQuant05Hadley_plot, nsQuant95Hadley_plot,
nsQuant05CCSM_plot, nsQuant95CCSM_plot,
nsQuant05ECBilt_plot, nsQuant95ECBilt_plot, ncol = 2)
dev.off()
pdf(file = './pdf/ns_quant.pdf', width = 11, height = 8.5)
plot_grid(title05, plot_grid(nsQuant05Pollen_plot, nsQuant05Hadley_plot,
nsQuant05CCSM_plot, nsQuant05ECBilt_plot, ncol = 2),
title95,
plot_grid(nsQuant95Pollen_plot, nsQuant95Hadley_plot,
nsQuant95CCSM_plot, nsQuant95ECBilt_plot, ncol = 2),
ncol = 1, rel_heights = c(0.2, 1))
plot_grid(title05, title95, nsQuant05Pollen_plot, nsQuant95Pollen_plot,
nsQuant05Hadley_plot, nsQuant95Hadley_plot,
nsQuant05CCSM_plot, nsQuant95CCSM_plot,
nsQuant05ECBilt_plot, nsQuant95ECBilt_plot,
ncol = 2, rel_heights = c(0.2, 1))
dev.off()
pdf(file = './pdf/ns_quant.pdf', width = 11, height = 8.5)
plot_grid(title05, plot_grid(nsQuant05Pollen_plot, nsQuant05Hadley_plot,
nsQuant05CCSM_plot, nsQuant05ECBilt_plot, ncol = 2),
title95,
plot_grid(nsQuant95Pollen_plot, nsQuant95Hadley_plot,
nsQuant95CCSM_plot, nsQuant95ECBilt_plot, ncol = 2),
ncol = 1, rel_heights = c(0.2, 1))
plot_grid(title05, title95, nsQuant05Pollen_plot, nsQuant95Pollen_plot,
nsQuant05Hadley_plot, nsQuant95Hadley_plot,
nsQuant05CCSM_plot, nsQuant95CCSM_plot,
nsQuant05ECBilt_plot, nsQuant95ECBilt_plot,
ncol = 2, rel_heights = c(0.2, 1,1,1))
dev.off()
pdf(file = './pdf/ns_quant.pdf', width = 11, height = 8.5)
plot_grid(title05, plot_grid(nsQuant05Pollen_plot, nsQuant05Hadley_plot,
nsQuant05CCSM_plot, nsQuant05ECBilt_plot, ncol = 2),
title95,
plot_grid(nsQuant95Pollen_plot, nsQuant95Hadley_plot,
nsQuant95CCSM_plot, nsQuant95ECBilt_plot, ncol = 2),
ncol = 1, rel_heights = c(0.2, 1))
plot_grid(title05, title95, nsQuant05Pollen_plot, nsQuant95Pollen_plot,
nsQuant05Hadley_plot, nsQuant95Hadley_plot,
nsQuant05CCSM_plot, nsQuant95CCSM_plot,
nsQuant05ECBilt_plot, nsQuant95ECBilt_plot,
ncol = 2, rel_heights = c(0.2, 1, 1 , 1, 1))
dev.off()
# ENM Template, Fagus
# Author: Lauren Jenkins
# 25 January 2022
# Last updated: 13 June 2022
rm(list = ls())
## load packages ##
# for visualization #
library(sp)
library(sf)
library(ggplot2)
# maps #
library(maps)
library(rnaturalearth)
library(rnaturalearthdata)
library(rnaturalearthhires)
# for handling rasters #
library(raster)
library(rgdal)
library(dismo)
# library(rgeos) # not used, but may be helpful when debugging
# additional tools #
library(tools)
library(units)
library(dplyr)
library(tidyr)
# enm tools #
library(enmSdm)
library(maxnet)
## genus constants ##
genus <- 'fagus'
speciesList <- paste0('Fagus ',
c('grandifolia'))
setwd(paste0('/Volumes/lj_mac_22/MOBOT/by_genus/', genus))
# set constants #
nad27_crs <- getCRS('nad27')
wgs84_crs <- getCRS('wgs84')
ll <- c('longitude', 'latitude')
yrs <- seq(22 , 1, by = -1) # timestep indicies helper
climYears <- seq(21000, 0, by=-1000)
climYear <- 0 # only modeling present-day in this script
pc <- 5 # number of principal components used from environmental data
gcmList <- c('hadley', 'ccsm', 'ecbilt') # general circulation models for env data
# reference raster from ccsm env data for cell size, used in thinning
lorenzRast <- raster::raster('/Volumes/lj_mac_22/MOBOT/by_genus/env_data/ccsm/tifs/0BP/an_avg_ETR.tif')
gcm <- 'hadley'
# load climate for given gcm
load(paste0('/Volumes/lj_mac_22/MOBOT/by_genus/env_data/', gcm,
'/PCA_climate_rasters_pc', pc, '.Rdata'))
clim
